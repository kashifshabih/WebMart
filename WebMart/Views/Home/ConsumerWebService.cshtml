
@{
    ViewBag.Title = "ConsumerWebService";
}

<h2>ConsumerWebService</h2>


<table>

    <tr>
        <td>Credit Card Number</td>
        <td>@Html.TextBox("CreditCardNumber")</td>
    </tr>

    <tr>
        <td>Credit Card Pin</td>
        <td>@Html.TextBox("CreditCardPin")</td>
    </tr>

    <tr>

        <td colspan="2"><button onclick="PostCreditCard();return false;"/></td>

    </tr>

</table>


<script type="text/javascript">
    function PostCreditCard() {
        alert("kashif");
        var CreditCard = { CreditCardNumber: $('#CreditCardNumber').val(), CreditCardPin: $('#CreditCardPin').val() };
        var TestOrder = { CreditCardNumber: $('#CreditCardNumber').val(), CreditCardPin: $('#CreditCardPin').val() };
        var transaction = { CreditCardNumber: $('#CreditCardNumber').val(), CreditCardPin: $('#CreditCardPin').val() };
        $.ajax({

            type: "POST",
            data: JSON.stringify(CreditCard),
            url: "http://localhost:3265/api/CreditCard",
            contentType: "application/json",

            success: function (data) {
                alert(data);

                $.ajax({
                    // edit to add steve's suggestion.
                    //url: "/ControllerName/ActionName",
                    type: "POST",
                    data: TestOrder,
                    //url: '<%= Url.Action("Create", "TestOrder") %>',
                    url: "/TestOrder/Create",
                    success: function (data) {
                        // your data could be a View or Json or what ever you returned in your action method 
                        // parse your data here
                        alert("success saving test order");
                    },
                    error: function () {
                        alert("error");
                    }
                });


                $.ajax({
                    type: "POST",
                    data: JSON.stringify(transaction),
                    url: "http://localhost:3298/api/Transactions",
                    contentType: "application/json",
                    success: function (data) {
                        // your data could be a View or Json or what ever you returned in your action method 
                        // parse your data here
                        alert("success saving test order 2");
                    },
                    error: function () {
                        alert("error");
                    }
                });

            },
            error: function () {
                        alert("error");
                    }
        });
    }

        //jQuery.support.cors = true;
        //var employee = {
        //    ID: $('#txtaddEmpid').val(),
        //    EmpName: $('#txtaddEmpName').val(),
        //    EmpDepartment: $('#txtaddEmpDep').val(),
        //    EmpMobile: $('#txtaddEmpMob').val()
        //};

        //$.ajax({
        //    url: 'http://localhost:8080/API_SVC/api/EmployeeAPI',
        //    type: 'POST',
        //    data: JSON.stringify(employee),
        //    contentType: "application/json;charset=utf-8",
        //    success: function (data) {
        //        WriteResponse(data);
        //    },
        //    error: function (x, y, z) {
        //        alert(x + '\n' + y + '\n' + z);
        //    }
        //});
    
</script>





