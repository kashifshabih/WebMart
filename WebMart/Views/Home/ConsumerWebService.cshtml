@{
    ViewBag.Title = "ConsumerWebService";
}

<h2>ConsumerWebService</h2>

<table>
    <tr>
        <td>Credit Card Number</td>
        <td>@Html.TextBox("CreditCardNumber")</td>
    </tr>
    <tr>
        <td>Credit Card Pin</td>
        <td>@Html.TextBox("CreditCardPin")</td>
    </tr>
    <tr>
        <td colspan="2"><button onclick="PostCreditCard();return false;"/></td>
    </tr>
</table>

<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
<script type="text/javascript">
    function PostCreditCard() {                
        /*var CreditCard = {
            CreditCardNumber: CryptoJS.MD5($('#CreditCardNumber').val()),
            CreditCardPin: CryptoJS.MD5($('#CreditCardPin').val())
        };
        alert($('#CreditCardNumber').val() + ' => ' + CryptoJS.MD5($('#CreditCardNumber').val()));
        alert($('#CreditCardPin').val() + ' => ' + CryptoJS.MD5($('#CreditCardPin').val()));*/
        var CreditCard = { CreditCardNumber: $('#CreditCardNumber').val(), CreditCardPin: $('#CreditCardPin').val() };
        var TestOrder = { CreditCardNumber: $('#CreditCardNumber').val(), CreditCardPin: $('#CreditCardPin').val() };
        var transaction = { CreditCardNumber: $('#CreditCardNumber').val(), CreditCardPin: $('#CreditCardPin').val() };
        $.ajax({

            type: "POST",
            data: JSON.stringify(CreditCard),
            url: "http://localhost:3265/api/CreditCard",
            contentType: "application/json",

            success: function (data) {
                alert(data);

                $.ajax({
                    // edit to add steve's suggestion.
                    //url: "/ControllerName/ActionName",
                    type: "POST",
                    data: TestOrder,
                    //url: '<%= Url.Action("Create", "TestOrder") %>',
                    url: "/TestOrder/Create",
                    success: function (data) {
                        // your data could be a View or Json or what ever you returned in your action method
                        // parse your data here
                        alert("success saving test order");
                    },
                    error: function () {
                        alert("error");
                    }
                });


                $.ajax({
                    type: "POST",
                    data: JSON.stringify(transaction),
                    url: "http://localhost:3298/api/Transactions",
                    contentType: "application/json",
                    success: function (data) {
                        // your data could be a View or Json or what ever you returned in your action method
                        // parse your data here
                        alert("success saving test order 2");
                    },
                    error: function () {
                        alert("error");
                    }
                });

            },
            error: function () {
                        alert("error");
                    }
        });
    }        
</script>